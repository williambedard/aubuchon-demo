{% layout none %}
{% assign a = 0%} {% assign b = 1 %} {% assign c = 2 %}
{% assign noImageSrc = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMzYuODk5OCA1Ny43NDIyQzM1LjA1ODIgNTguMDA4MyAzMy43NzQ3IDU5Ljc2MTIgMzQuMDMzMSA2MS42NTc2TDQ0LjYwNDggMTM5LjIzOUM0NC43NTU2IDE0MC4zNDUgNDUuMzk4MiAxNDEuMjU2IDQ2LjI3MzMgMTQxLjc3VjEwMC40MDZMNDEuMzkwNyA2NC41NzU0QzQxLjMyNjEgNjQuMTAxMyA0MS42NDcgNjMuNjYzMSA0Mi4xMDc0IDYzLjU5NjVMMTQyLjE4NSA0OS4xMzhDMTQyLjY0NSA0OS4wNzE1IDE0My4wNzEgNDkuNDAxOSAxNDMuMTM2IDQ5Ljg3NTlMMTQ1LjAyNCA2My43MzA1SDE1MS45ODRMMTQ5LjQyOSA0NC45ODU5QzE0OS4xNzEgNDMuMDg5NiAxNDcuNDY4IDQxLjc2OCAxNDUuNjI3IDQyLjAzNDFMMzYuODk5OCA1Ny43NDIyWiIgZmlsbD0iIzhEOEQ4RCIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTUwLjQ3MzQgNzAuMTkxOEM1MC40NzM0IDY4LjI3NjkgNTEuOTgxIDY2LjcyNDYgNTMuODQwNyA2Ni43MjQ2SDE2My42MzNDMTY1LjQ5MiA2Ni43MjQ2IDE2NyA2OC4yNzY5IDE2NyA3MC4xOTE4VjE0OC41MzNDMTY3IDE1MC40NDggMTY1LjQ5MiAxNTIgMTYzLjYzMyAxNTJINTMuODQwN0M1MS45ODEgMTUyIDUwLjQ3MzQgMTUwLjQ0OCA1MC40NzM0IDE0OC41MzNWNzAuMTkxOFpNNTcuMzY2IDc0LjEzNEM1Ny4zNjYgNzMuNjU1MyA1Ny43NDI5IDczLjI2NzIgNTguMjA3OCA3My4yNjcySDE1OS4yNjZDMTU5LjczMSA3My4yNjcyIDE2MC4xMDcgNzMuNjU1MyAxNjAuMTA3IDc0LjEzNFYxNDQuNTkxQzE2MC4xMDcgMTQ1LjA2OSAxNTkuNzMxIDE0NS40NTcgMTU5LjI2NiAxNDUuNDU3SDU4LjIwNzhDNTcuNzQyOSAxNDUuNDU3IDU3LjM2NiAxNDUuMDY5IDU3LjM2NiAxNDQuNTkxVjc0LjEzNFoiIGZpbGw9IiM4RDhEOEQiLz4KPHBhdGggZD0iTTkwLjEwNTQgOTMuODkzQzkwLjEwNTQgOTkuNTI3NSA4NS42Njk0IDEwNC4wOTUgODAuMTk3NCAxMDQuMDk1Qzc0LjcyNTQgMTA0LjA5NSA3MC4yODk0IDk5LjUyNzUgNzAuMjg5NCA5My44OTNDNzAuMjg5NCA4OC4yNTg2IDc0LjcyNTQgODMuNjkxIDgwLjE5NzQgODMuNjkxQzg1LjY2OTQgODMuNjkxIDkwLjEwNTQgODguMjU4NiA5MC4xMDU0IDkzLjg5M1oiIGZpbGw9IiM4RDhEOEQiLz4KPHBhdGggZD0iTTEyMC40MjEgMTA1LjUzNUMxMjAuNDIxIDEwNS41MzUgMTA2LjQyMSAxMDUuMTQ4IDk3LjY0MzkgMTA1LjUzNUM5MC41OSAxMTYuMTI3IDc0Ljc1ODggMTI5LjI2NiA2Mi4yMTIxIDEzNC41MzRDNjIuMjEyMSAxMzguMjQ4IDYyLjIxMjEgMTQxLjAyMSA2Mi4yMTIxIDE0MS4wMjFIMTU1Ljc5OVYxMzQuNTM0QzE0Ni41MzggMTMwLjQ4NyAxMjUuNDgzIDExNi4yMzcgMTIwLjQyMSAxMDUuNTM1WiIgZmlsbD0iIzhEOEQ4RCIvPgo8cGF0aCBkPSJNMTE4LjM3NSAxMDguNjQySDk5LjQ3NDlMOTEuODgyNCAxMTcuOTAxSDk2LjkzODFMOTkuNjY4NiAxMTQuMjc4QzEwMS4wMTcgMTEyLjQ4OSAxMDMuNjQxIDExMi40ODkgMTA0Ljk4OSAxMTQuMjc4TDEwNy43MiAxMTcuOTAxSDEwOS45NjlMMTEyLjcgMTE0LjI3OEMxMTQuMDQ4IDExMi40ODkgMTE2LjY3MiAxMTIuNDg5IDExOC4wMiAxMTQuMjc4TDEyMC43NTEgMTE3LjkwMUgxMjUuODA2TDExOC4zNzUgMTA4LjY0MloiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=" %}
{% assign product_option0 = product.options_with_values[a].values %}
{% assign product_option1 = product.options_with_values[b].values %}
{% assign product_option2 = product.options_with_values[c].values %}
{% assign optionSize = product.options.size %}
{
{% if optionSize > 0 %}
{% for value1 in product_option0 %}
      {% assign subOptionValue = value1 %}
      {% assign neededProducts = product.variants | where:'option1',value1 %}
      {% assign priceProducts = neededProducts | sort:'price' %}
      {% assign availbaleProducts = neededProducts | where:'available' %}
      {{ value1 | json }}:{"id":{{ neededProducts[a].id | json }},
                    "available":{% if availbaleProducts.size > 0 %}true{% else %}false {% endif %} ,
                    "src": {% if product.featured_image %}{{ neededProducts[a].featured_image.src | default: product.featured_image | image_url: width: 720 | json }}{% else %}{{ noImageSrc | json }}{% endif %},
                    "price":{{ priceProducts[a].price | json }}{% unless optionSize ==1 %},{% endunless %}
                    {% if optionSize > 1 %}
                    {% for value2 in product_option1 %}
                        {% assign subOptionValue = value2 %}
                        {% assign neededProducts = product.variants | where:'option1',value1%}
                        {% assign neededProducts = neededProducts | where:'option2',value2 %}
                        {% assign priceProducts = neededProducts | sort:'price' %}
                        {% assign availbaleProducts = neededProducts | where:'available' %}
                        {{ value2 | json }}:{"id":{{ neededProducts[a].id | json }},
                                      "available":{% if availbaleProducts.size > 0 %}true{% else %}false {% endif %} ,
                                      "src": {% if product.featured_image %}{{ neededProducts[a].featured_image.src | default: product.featured_image | image_url: width: 720 | json }}{% else %}{{ noImageSrc | json }}{% endif %},
                                      "price":{{ priceProducts[a].price | json }}{% unless optionSize ==2 %},{% endunless %}
                                      {% if optionSize > 2 %}
                                      {% for value3 in product_option2 %}
                                          {% assign subOptionValue = value3 %}
                                          {% assign neededProducts = product.variants | where:'option1',value1 %}
                                          {% assign neededProducts = neededProducts | where:'option2',value2 %}
                                          {% assign neededProducts = neededProducts | where:'option3',value3 %}
                                          {% assign priceProducts = neededProducts | sort:'price' %}
                                          {% assign availbaleProducts = neededProducts | where:'available' %}
                                          {{ value3 | json }}:{"id":{{ neededProducts[a].id | json }},
                                                         "available":{% if availbaleProducts.size > 0 %}true{% else %}false {% endif %} ,
                                                         "src": {% if product.featured_image %}{{ neededProducts[a].featured_image.src | default: product.featured_image | image_url: width: 720 | json }}{% else %}{{ noImageSrc | json }}{% endif %},
                                                         "price":{{ priceProducts[a].price | json }}
                                                        }{% unless forloop.last %},{% endunless %}
                                      {% endfor %}
                                      {% endif %}
                                      }{% unless forloop.last %},{% endunless %}
                    {% endfor %}
                    {% endif %}
                  }{% unless forloop.last %},{% endunless %}
{% endfor%}
{% endif %}
}
